<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ES6 | WW&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/assets/images/favicon.ico">
    <meta name="description" content="小万的学习日记">
    
    <link rel="preload" href="/assets/css/0.styles.f906e04f.css" as="style"><link rel="preload" href="/assets/js/app.b204aa68.js" as="script"><link rel="preload" href="/assets/js/3.11858a94.js" as="script"><link rel="preload" href="/assets/js/28.95fa210b.js" as="script"><link rel="prefetch" href="/assets/js/10.4ba6d33d.js"><link rel="prefetch" href="/assets/js/11.25404561.js"><link rel="prefetch" href="/assets/js/12.c5f7c57a.js"><link rel="prefetch" href="/assets/js/13.b3f4b8fa.js"><link rel="prefetch" href="/assets/js/14.46540222.js"><link rel="prefetch" href="/assets/js/15.97723425.js"><link rel="prefetch" href="/assets/js/16.d39c92ed.js"><link rel="prefetch" href="/assets/js/17.1270b2cb.js"><link rel="prefetch" href="/assets/js/18.4979c0d3.js"><link rel="prefetch" href="/assets/js/19.0e93150c.js"><link rel="prefetch" href="/assets/js/2.4e92778c.js"><link rel="prefetch" href="/assets/js/20.a615aa84.js"><link rel="prefetch" href="/assets/js/21.991fd6a0.js"><link rel="prefetch" href="/assets/js/22.887e4024.js"><link rel="prefetch" href="/assets/js/23.eed1eb86.js"><link rel="prefetch" href="/assets/js/24.f6f628c5.js"><link rel="prefetch" href="/assets/js/25.e0c52e81.js"><link rel="prefetch" href="/assets/js/26.d0698039.js"><link rel="prefetch" href="/assets/js/27.377a3e91.js"><link rel="prefetch" href="/assets/js/29.f06819f4.js"><link rel="prefetch" href="/assets/js/30.6d27df40.js"><link rel="prefetch" href="/assets/js/31.56562f0a.js"><link rel="prefetch" href="/assets/js/32.8a12d07b.js"><link rel="prefetch" href="/assets/js/33.b1f03f72.js"><link rel="prefetch" href="/assets/js/34.769a69e9.js"><link rel="prefetch" href="/assets/js/35.4b6a6416.js"><link rel="prefetch" href="/assets/js/36.82131ca9.js"><link rel="prefetch" href="/assets/js/37.a00ea343.js"><link rel="prefetch" href="/assets/js/38.56b3fee1.js"><link rel="prefetch" href="/assets/js/39.1c786cf3.js"><link rel="prefetch" href="/assets/js/4.20549dd4.js"><link rel="prefetch" href="/assets/js/40.e55e5d14.js"><link rel="prefetch" href="/assets/js/41.74542fa5.js"><link rel="prefetch" href="/assets/js/42.5ac0cd94.js"><link rel="prefetch" href="/assets/js/43.37703fe3.js"><link rel="prefetch" href="/assets/js/44.bb3c609d.js"><link rel="prefetch" href="/assets/js/45.84d753d2.js"><link rel="prefetch" href="/assets/js/46.f5182ee4.js"><link rel="prefetch" href="/assets/js/47.410f1d3f.js"><link rel="prefetch" href="/assets/js/48.57f15450.js"><link rel="prefetch" href="/assets/js/49.8536be33.js"><link rel="prefetch" href="/assets/js/5.67ea1406.js"><link rel="prefetch" href="/assets/js/50.4285cc53.js"><link rel="prefetch" href="/assets/js/6.eb70783c.js"><link rel="prefetch" href="/assets/js/7.0c2fc075.js"><link rel="prefetch" href="/assets/js/8.c43d5f7e.js"><link rel="prefetch" href="/assets/js/9.63f08a56.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f906e04f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">WW's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/accumulate/" class="nav-link router-link-active">
  前端基础
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法题库
</a></div><div class="nav-item"><a href="/internship/" class="nav-link">
  实习日记
</a></div><div class="nav-item"><a href="/interview/accumulates/html.html" class="nav-link">
  面试总结
</a></div><div class="nav-item"><a href="https://github.com/Elvira-wan" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gitgub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/accumulate/" class="nav-link router-link-active">
  前端基础
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法题库
</a></div><div class="nav-item"><a href="/internship/" class="nav-link">
  实习日记
</a></div><div class="nav-item"><a href="/interview/accumulates/html.html" class="nav-link">
  面试总结
</a></div><div class="nav-item"><a href="https://github.com/Elvira-wan" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gitgub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/accumulate/" aria-current="page" class="sidebar-link">前端基础</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>前端三剑客</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/accumulate/base/HTML5.html" class="sidebar-link">HTML5(Hyper Text Markup Language)笔记及问题</a></li><li><a href="/accumulate/base/CSS3.html" class="sidebar-link">CSS3(Cascading  Style  Sheet)笔记及问题</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>JS相关概念</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/accumulate/base/JS_base/JS.html" class="sidebar-link">JavaScript笔记及问题</a></li><li><a href="/accumulate/base/JS_base/objectOriented.html" class="sidebar-link">面 向 对 象</a></li><li><a href="/accumulate/base/JS_base/DOM.html" class="sidebar-link">DOM</a></li><li><a href="/accumulate/base/JS_base/BOM.html" class="sidebar-link">BOM</a></li><li><a href="/accumulate/base/JS_base/ES6.html" aria-current="page" class="active sidebar-link">ES6</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/accumulate/base/JS_base/regExp.html" class="sidebar-link">正则表达式</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前后端交互</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>主流框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>进阶部分</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="es6"><a href="#es6" class="header-anchor">#</a> ES6</h1> <p></p><div class="table-of-contents"><ul><li><a href="#变量声明的三种方法-var-let-const">变量声明的三种方法 (var, let, const)</a></li><li><a href="#模板字符串">模板字符串</a></li><li><a href="#解构赋值">解构赋值</a></li><li><a href="#剩余参数">剩余参数</a></li><li><a href="#扩展运算符">扩展运算符（...）</a></li><li><a href="#迭代器">迭代器</a></li><li><a href="#箭头函数">箭头函数 ( =&gt; )</a></li><li><a href="#对象字面量的增强">对象字面量的增强</a></li><li><a href="#函数参数的默认值">函数参数的默认值</a></li><li><a href="#set-和-map">Set 和 Map</a></li><li><a href="#es6-新增方法">ES6 新增方法</a></li><li><a href="#promise-异步函数">Promise 异步函数</a></li><li><a href="#await-和-async">await 和 async</a></li><li><a href="#class类">Class类</a></li></ul></div><p></p> <h3 id="变量声明的三种方法-var-let-const"><a href="#变量声明的三种方法-var-let-const" class="header-anchor">#</a> 变量声明的三种方法 (var, let, const)</h3> <hr> <blockquote><p><code>var</code>：</p> <p>声明的变量会被自动添加到最接近的上下文；</p> <p>有变量的声明提升</p> <p>声明提升只提升定义不提升值</p></blockquote> <blockquote><p><code>let</code>：</p> <p>作用域范围只在块级作用域 ( if，while，for 或 单纯的 {} ) 中</p> <p><strong>不能二次声明</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// case1：</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>		<span class="token comment">// 报错</span>

<span class="token comment">// case2:</span>
<span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token comment">// 报错，即使前一个a不是使用let声明的</span>
   <span class="token comment">// 只要这个变量名被用过再次用let就会报错</span>
<span class="token punctuation">}</span>
</code></pre></div><p>没有变量的声明提升</p> <p>十分适用于 for 语句的迭代中</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// ReferenceError：i is undefined;</span>
</code></pre></div><p>特别地：就算 let 定义的变量没有被块级作用域包裹，就将 let 定义写在全局中，其定义的变量也不属于 <code>window</code> 对象；</p></blockquote> <blockquote><p><code>const</code>：</p> <p>与 let 相同，作用于块级作用域，没有变量声明提升</p> <p>此外，必须在声明时就设定好初始值，且<strong>不能二次赋值</strong></p> <p>但这里说的不能二次赋值是指 const 变量如果是一个基本数据类型，则不能被二次赋值，若 const 变量为一个引用，例如对象，则该对象的键依旧可以被重新赋值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>；
<span class="token comment">// person = new object();		// 报错</span>
person<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Nichola'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// Nichola</span>
</code></pre></div><p>若想使对象的值也不可改变的话，可以使用 <code>const person = Object.freeze({});</code></p></blockquote> <p>此外 <code>let</code> 和 <code>const</code> 中存在一个暂时性死区：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">fun</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 1</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// Uncaught ReferenceError: Cannot access 'b' before initialization</span>
    <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这里的 <code>b</code>无法获取到函数作用域外的 <code>b</code> 的值就是因为，在 <code>fun</code> 中 <code>let b</code> 的声明导致函数形成了暂时性死区，无法顺着作用域链去全局中搜索变量。</p> <h3 id="模板字符串"><a href="#模板字符串" class="header-anchor">#</a> 模板字符串</h3> <hr> <blockquote><p><code>'HH'</code> 或者 <code>&quot;WW&quot;</code>，这种用单引号或双引号括住的称为一般字符串</p> <p>用 `WW` (反引号) 表示的即为模板字符串；</p> <p>一般字符串只能用加号拼接不同字符串，但是模板字符串可以使用 <code>${变量}</code> 来拼接</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'HH'</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">,</span>
    sex<span class="token operator">:</span> <span class="token string">'male'</span>
<span class="token punctuation">}</span>
<span class="token comment">// 一般字符串输出函数</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我的名字是'</span> <span class="token operator">+</span> person<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">', 我今年'</span> <span class="token operator">+</span> person<span class="token punctuation">.</span>age <span class="token operator">+</span> <span class="token string">'岁了, 我的性别是'</span> <span class="token operator">+</span> person<span class="token punctuation">.</span>sex<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 模板字符串输出</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">我的名字是</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>person<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, 我今年</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>person<span class="token punctuation">.</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">岁了,我的性别是</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>person<span class="token punctuation">.</span>sex<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre></div><ul><li><p>模板字符串中所有的空格，换行，缩进都会被保留在输出中</p></li> <li><p>输出 ` 和  \ 等特殊字符需要采用转义字符： \`  和 \\</p></li> <li><p>模板字符串的注入：<code>${}</code></p> <ul><li>只要最终可以得出一个值的，都可以注入到模板字符串中;</li></ul></li></ul> <p>模板字符串例子：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>学生信息表<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>list<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">list-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>信息加载中<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> stu <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        username<span class="token operator">:</span> <span class="token string">'HH'</span><span class="token punctuation">,</span>
        age<span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">,</span>
        sex<span class="token operator">:</span> <span class="token string">'male'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        username<span class="token operator">:</span> <span class="token string">'WW'</span><span class="token punctuation">,</span>
        age<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
        sex<span class="token operator">:</span> <span class="token string">'famale'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> stu<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    html <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;li&gt;我的名字是：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>stu<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>username<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, 我的年龄为</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>stu<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, 性别为 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>stu<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>sex<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/li&gt;</span><span class="token template-punctuation string">`</span></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
list<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> html<span class="token punctuation">;</span>
</code></pre></div><ol><li><code>stu</code> 是一个数组，里面的每个项都为对象，而不是对象中包含对象；</li> <li>首先要将 <code>html</code> 的值设置为 <code>''</code>，否则会导致后面 <code>html +=</code> 时 <code>html</code> 前面初始为 <code>undefined</code>;</li> <li>一定要预先定义 <code>html</code>，否则无法获取其值；</li></ol> <h3 id="解构赋值"><a href="#解构赋值" class="header-anchor">#</a> 解构赋值</h3> <hr> <blockquote><p>解析某一数据的结构，将我们想要的东西提取出来，赋值给常量或者是变量</p> <p><code>eg: const [a, b, c] = [1, 2, 3];</code></p> <p>原理：</p> <ul><li><p>模式/结构匹配 (数组配数组，对象配对象，不能数组配对象)</p></li> <li><p>相同 索引值/属性名 完成赋值，如果不想取的数可以直接用逗号跳过</p></li></ul> <p>eg:  <code>const [a, [,,b], c] = [1, [2, 3, 4], 5]</code>;</p> <p>此时 <code>a = 1, b = 4, c = 5</code></p></blockquote> <p>数组解构赋值的默认值：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 此时输出的 a = undefined, b = undefined</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment">// 此时输出 a = 1, b = 2</span>
<span class="token comment">// 只有在当解构赋值的值严格等于(===)undefined时，才会将初始值赋给变量或常量</span>
<span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我被执行了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>a <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 此时 a = 1,且控制台没有输出语句</span>
<span class="token comment">// 因为解构赋值的初始值是惰性赋值的，即若不被赋初始值，则一句也不执行</span>
</code></pre></div><p>同理，当对象的属性值严格等于 <code>undefined</code> 时，默认值才会生效；</p> <p>如果将一个已经声明的变量用于对象的解构赋值：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">// let {x} = {x: 1};	// 报错：let声明的变量不能重新赋值</span>
<span class="token comment">// {x} = {x: 1}			// uncaught SyntaxError: Unexpected token '='</span>
<span class="token comment">// 因为不写 let 浏览器会将 {x} 误解成一个块作用域，我们没办法给快作用域赋值</span>
<span class="token comment">// 因此我们可以将使用以下方法</span>
<span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 这样便可正确赋值</span>
</code></pre></div><p><strong>特别地：对象解构赋值可以顺着原型链获取到继承的属性</strong>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token punctuation">{</span>x<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>；
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// undefined</span>
<span class="token keyword">let</span> <span class="token punctuation">{</span>toString<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>toString<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 输出toString方法</span>
</code></pre></div><p>数组和对象的解构赋值的应用：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 数组解构赋值的应用场景</span>
<span class="token comment">// 1. 类数组的解构赋值：arguments 和 NodeList</span>
<span class="token comment">// arguments</span>
<span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// NodeList</span>
<span class="token keyword">let</span> <span class="token punctuation">[</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> p3<span class="token punctuation">]</span> <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> p3<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2. 函数参数的解构赋值</span>
<span class="token keyword">const</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 一般函数</span>
<span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token parameter">arr</span> <span class="token operator">=&gt;</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 解构赋值参数的函数</span>
<span class="token keyword">const</span> <span class="token function-variable function">add1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add1</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 3</span>

<span class="token comment">// 3. 交换变量的值</span>
<span class="token keyword">var</span> w <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> h <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> temp<span class="token punctuation">;</span>
<span class="token comment">// 一般情况交换 a, b 的值</span>
temp <span class="token operator">=</span> w<span class="token punctuation">;</span>
w <span class="token operator">=</span> h<span class="token punctuation">;</span>
h <span class="token operator">=</span> temp<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 2, 1</span>
<span class="token comment">// 解构赋值交换</span>
<span class="token keyword">var</span> w1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> h1 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>w1<span class="token punctuation">,</span> h1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>h1<span class="token punctuation">,</span> w1<span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>w1<span class="token punctuation">,</span> h1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 2, 1</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">// 对象的解构赋值的应用</span>
<span class="token comment">// 1. 函数参数的解构赋值</span>
<span class="token comment">// 一般写法</span>
<span class="token keyword">function</span> <span class="token function">personMessage</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>username<span class="token punctuation">,</span> user<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">personMessage</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// HH 21</span>
<span class="token comment">// 解构函数写法</span>
<span class="token keyword">const</span> <span class="token function-variable function">personMessage1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>username<span class="token punctuation">,</span> age<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">personMessage1</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// HH 21</span>

<span class="token comment">// 2. 复杂嵌套</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    x<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    y<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    z<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token constant">W</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token constant">H</span><span class="token operator">:</span> <span class="token number">6</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 要求获取 3，6 和 y, z</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>
    <span class="token comment">// y: y,</span>
    <span class="token comment">// 可简写为</span>
    y<span class="token punctuation">,</span>
    y<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">,</span>y3<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// z: z,</span>
    <span class="token comment">// 可简写为</span>
    z<span class="token punctuation">,</span>
    z<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token constant">H</span><span class="token operator">:</span> <span class="token constant">H</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> obj<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> y3<span class="token punctuation">,</span> z<span class="token punctuation">,</span> <span class="token constant">H</span><span class="token punctuation">)</span>
</code></pre></div><p>其他类型的解构赋值：</p> <ul><li><p>字符串：既可以按照数组的形式解构赋值，也可以按照对象的形式解构赋值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// h l</span>
<span class="token comment">// 如果是按照数组的形式进行解构，就将字符串看成一个类数组</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token operator">:</span> a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span> b<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
<span class="token comment">// 如果是按照对象来进行解构那么其属性名就为该字符串的一个索引</span>
</code></pre></div></li> <li><p>数值和布尔值的解构赋值：只可以以对象的形式进行解构赋值，系统会先将数值和布尔值转换为对象，然后进行解构赋值</p></li> <li><p><code>null</code> 和 <code>undefined</code>：无法解构赋值，报错；</p></li></ul> <h3 id="剩余参数"><a href="#剩余参数" class="header-anchor">#</a> 剩余参数</h3> <hr> <blockquote><p><strong>概念：在函数的参数为不确定的个数时，我们可以使用 (...剩余参数名) 的形式来表表示有不确定数目的函数的参数</strong></p> <p>特别地：剩余参数是一个数组的形式，即使没有值也是一个空数组</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 定义剩余参数时要在剩余参数前加(...)，使用剩余参数时不需要加(...)</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// 1 2 [3]	</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 1 2 [3, 4]</span>
</code></pre></div><p>注意：</p> <ol><li>在箭头函数使用剩余参数时，即使参数列表中只书写一个剩余参数，都必须书写参数的圆括号；</li> <li>箭头函数无法使用 <code>arguments</code>，但是可以使用剩余参数来获取传入的参数；</li> <li>剩余参数的位置只能放在所有参数的后面，不能置于中间；</li></ol> <h3 id="扩展运算符"><a href="#扩展运算符" class="header-anchor">#</a> 扩展运算符（...）</h3> <hr> <blockquote><p><strong>概念：对象中的扩展运算符（...）用于取出 数组或对象 中所有可便利属性，拷贝到当前 数组或对象中</strong></p> <p>扩展运算符与剩余参数的区别：扩展运算符是将 数组或对象中 的数字展开，而剩余参数是将参数合成一个数组；</p></blockquote> <p>用法一：<strong>复制 数组或对象</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> bar <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> baz <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>bar <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// { a: 1, b: 2 }</span>
</code></pre></div><p>上述方法等价于：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> bar <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> baz <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> bar<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { a: 1, b: 2 }</span>
</code></pre></div><p><code>Object.assign</code>方法用于对象的合并，将源对象(source)的所有可枚举属性，<strong>复制</strong>到目标对象(target)，此方法第一个参数是目标对象，后面的参数都是源对象。若目标对象与源对象有同名属性，或者多个源对象有同名属性，则后面的属性会覆盖前面的属性。</p> <p>这里有点需要注意的是扩展运算符对对象实例的拷贝属于一种<strong>浅拷贝</strong>：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>obj1<span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token string">'2-edited'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {a: 1, b: 2}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  {a: 1, b: &quot;2-edited&quot;}</span>
<span class="token number">1234</span>
</code></pre></div><p><strong>上面这个例子扩展运算符拷贝的对象是<em>基础数据类型</em>，因此对<code>obj2</code>的修改并不会影响<code>obj1</code></strong>，如果改成这样：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token punctuation">{</span>nickName<span class="token operator">:</span> <span class="token string">'d'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>obj1<span class="token punctuation">}</span><span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>c<span class="token punctuation">.</span>nickName <span class="token operator">=</span> <span class="token string">'d-edited'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {a: 1, b: 2, c: {nickName: 'd-edited'}}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {a: 1, b: 2, c: {nickName: 'd-edited'}}</span>
<span class="token number">12345</span>
</code></pre></div><p>这里可以看到，对<code>obj2</code>的修改影响到了被拷贝对象<code>obj1</code>，<strong>因为<code>obj1</code>中的对象<code>c</code>是一个引用数据类型，拷贝的时候拷贝的是对象的引用</strong>。</p> <p>非对象的展开：如果展开的不是对象则会自动将非对象转换为对象，并将其属性罗列出来；但如果此时对 字符串 进行展开，则会自动将该字符串转换为一个类数组对象后展开；</p> <p>用法二：<strong>将类数组 (arguments、NodeList) 转化为数组</strong>，以方便使用一些只有数组有的方法</p> <p>用法三：<strong>数组或者对象之间的合并</strong></p> <h3 id="迭代器"><a href="#迭代器" class="header-anchor">#</a> 迭代器</h3> <hr> <blockquote><p>遍历器（Iterator）是一种接口，<strong>为各种不同的数据结构提供统一的访问机制</strong>。任何数据结构只要<strong>部署 Iterator 接口，就可以完成遍历操作</strong>（即依次处理该数据结构的所有成员）。</p></blockquote> <p>使用 <code>Iterator</code> 底层机制两步：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. 使用 Symbol.iterator() 方法将数组 [1, 2] 变为一个可便利对象  </span>
<span class="token keyword">const</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 2. 调用该集合方法</span>
<span class="token comment">// 可认为该集合有一个指针，value指向的是当前遍历的值，done表示遍历是否完成</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// {value: 1, done: false}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// {value: 2, done: false}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// {value: undefined, done: true}</span>
</code></pre></div><p>由于以上操作过于繁琐，则将Iterator封装成 <code>for...of...</code> 循环：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    consloe<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
<span class="token comment">// arr.keys()取得数组索引</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">of</span> arr<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">key：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// arr.values()获取值</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> value <span class="token keyword">of</span> arr<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">value：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// arr.entries()获取索引+值</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> arr<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">key：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, value：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对于非原生可便利对象添加方法是其变为可便利对象：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'WW.'</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
    sex<span class="token operator">:</span> <span class="token string">'female'</span>
<span class="token punctuation">}</span>
<span class="token comment">// 给对象添加可便利方法，调用该方法后，对象变为可遍历对象，含有next()方法，而next()方法中会返回 value和done的值</span>
<span class="token comment">// 因此可以设计为 Symbol.iterator -&gt; next() -&gt; value,done</span>
obj<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置一个索引指向对象的一个属性</span>
    <span class="token keyword">let</span> key <span class="token operator">=</span> <span class="token string">'name'</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token comment">// 返回next()方法，使得对象在调用 Symbol.iterator() 方法后变为可遍历对象含有 next() 方法</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 判断其当前索引指向的对象属性</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 设置索引指向的下一个对象属性</span>
                key <span class="token operator">=</span> <span class="token string">'age'</span><span class="token punctuation">;</span>
                <span class="token comment">// 因为每次next()执行之后都会返回一个对象，包含该索引所对应的值以及是否遍历完成，因此这里也进行返回</span>
                <span class="token keyword">return</span> <span class="token punctuation">{</span>
                    value<span class="token operator">:</span> <span class="token string">'WW.'</span><span class="token punctuation">,</span>
                    done<span class="token operator">:</span> <span class="token boolean">false</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'age'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                key <span class="token operator">=</span> <span class="token string">'sex'</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token punctuation">{</span>
                    value<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                    done<span class="token operator">:</span> <span class="token boolean">false</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'sex'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                key <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token punctuation">{</span>
                    value<span class="token operator">:</span> <span class="token string">'female'</span><span class="token punctuation">,</span>
                    done<span class="token operator">:</span> <span class="token boolean">false</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token punctuation">{</span>
                    value<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
                    done<span class="token operator">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><h5 id="iterator-的作用"><a href="#iterator-的作用" class="header-anchor">#</a> <code>Iterator</code> 的作用</h5> <ul><li><p>为各种数据结构，提供一个统一的、简便的访问接口</p></li> <li><p>使得数据结构的成员能够按某种次序排列</p></li> <li><p>ES6 创造了一种新的遍历命令for...of循环，Iterator 接口主要供for...of消费。</p></li></ul></li> <li><h5 id="iterator-的迭代过程"><a href="#iterator-的迭代过程" class="header-anchor">#</a> <code>Iterator</code> 的迭代过程</h5> <ul><li><p>所有的迭代器对象都会有一个<code>next</code>方法，每次调用都会返回一个对象:<code>{done: boolean, value: any}</code>。<code>value</code>表示当前成员的值，<code>done</code>表示是否还有更多的数据。迭代器内部会维护一个指针，指向当前成员的位置，每次调用<code>next</code>都会指向下一个成员。</p></li> <li><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">creatIterator</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          done<span class="token operator">:</span> index <span class="token operator">&gt;</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>
          value<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>done <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> arr<span class="token punctuation">[</span>index<span class="token operator">++</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> iterator <span class="token operator">=</span> <span class="token function">creatIterator</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// { done: false, value: 1 }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// { done: false, value: 2 }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// { done: false, value: 3 }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// { done: true, value: undefined }</span>
<span class="token comment">// 之后的调用都会返回相同的内容</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// { done: true, value: undefined }</span>
</code></pre></div></li></ul></li> <li><h5 id="使用了-iterator-的场合"><a href="#使用了-iterator-的场合" class="header-anchor">#</a> 使用了 <code>Iterator</code> 的场合</h5> <ul><li>数组的展开运算符</li> <li>数组的解构赋值</li> <li>Set 和 Map 的构造函数传参</li></ul></li></ul> <h3 id="箭头函数"><a href="#箭头函数" class="header-anchor">#</a> 箭头函数 ( =&gt; )</h3> <hr> <blockquote><p>箭头函数相当于匿名函数，并简化了函数定义</p></blockquote> <p><strong>箭头函数有两种格式：</strong></p> <ul><li><div class="language-js extra-class"><pre class="language-js"><code><span class="token parameter">x</span> <span class="token operator">=&gt;</span> x <span class="token operator">*</span> x
</code></pre></div><p>上面的箭头函数相当于：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>只包含一个表达式，连{ ... }和return都省略掉了，<strong>两者必须同时省略</strong>；</p></li> <li><p>还有一种可以包含多条语句，这时候就不能省略{ ... }和return：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token parameter">x</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">-</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>如果参数不是一个，就需要用括号()括起来：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 两个参数:</span>
<span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">*</span> x <span class="token operator">+</span> y <span class="token operator">*</span> y

<span class="token comment">// 无参数:</span>
<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">3.14</span>

<span class="token comment">// 可变参数:</span>
<span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token operator">...</span>rest</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> i<span class="token punctuation">,</span> sum <span class="token operator">=</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>rest<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sum <span class="token operator">+=</span> rest<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <p>如果要返回一个对象，就要注意，如果是单表达式，这么写的话会报错：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// SyntaxError:</span>
<span class="token parameter">x</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> x <span class="token punctuation">}</span>
</code></pre></div><p>因为和函数体的{ ... }有语法冲突，所以要改为：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ok:</span>
<span class="token parameter">x</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> foo<span class="token operator">:</span> x <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>箭头函数看上去是匿名函数的一种简写，但实际上，箭头函数和匿名函数有个明显的区别：
<strong>箭头函数内部的this是词法作用域，由上下文确定。</strong></p> <p>词法作用域就是定义在词法阶段的作用域。</p> <p>换句话说，<strong>词法作用域是由你在写代码时将变量和块作用域写在哪里来决定的</strong>，因此当词法分析器处理代码时会保持作用域不变 。</p></blockquote> <p>回顾前面的例子，由于JavaScript函数对this绑定的错误处理，下面的例子无法得到预期结果：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    birth<span class="token operator">:</span> <span class="token number">1990</span><span class="token punctuation">,</span>
    <span class="token function-variable function">getAge</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 对于函数getAge来说，是对象打点调用的 </span>
        <span class="token comment">// 所以此时上下文为 1990，this指向1990</span>
        <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>birth<span class="token punctuation">;</span> <span class="token comment">// 1990</span>
        <span class="token comment">// 由于用在fn()中无法通过this.birth获取值</span>
        <span class="token comment">// 因此我们只能通过备份上下文的方法来获取obj.birth的值</span>
        <span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// alert(that.birth);      // 1990</span>
        	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> that<span class="token punctuation">.</span>birth<span class="token punctuation">;</span> 
            <span class="token comment">// this指向window或undefined</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">// 而对于fn()来说，是直接调用的，此时上下文为window，则this为window</span>
        <span class="token comment">// 而window中并未定义birth，因此this.birth的值为undefined</span>
        <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// NaN</span>
</code></pre></div><p>现在，箭头函数完全修复了this的指向，this总是指向词法作用域，也就是外层调用者obj：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    birth<span class="token operator">:</span> <span class="token number">1990</span><span class="token punctuation">,</span>
    <span class="token function-variable function">getAge</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>birth<span class="token punctuation">;</span> <span class="token comment">// 1990</span>
        <span class="token comment">// 当使用箭头函数的时候，无论调用方法如何，其this指向的就是当前函数定义时所处环境的作用域</span>
        <span class="token keyword">var</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>birth<span class="token punctuation">;</span> 
        <span class="token comment">// this指向obj对象</span>
        <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 	<span class="token comment">// 31</span>
</code></pre></div><p>如果使用箭头函数，以前的那种hack写法，来备份上下文：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
</code></pre></div><p>就不再需要了。</p> <p>箭头函数不适用场景：</p> <ul><li>构造函数</li> <li>需要this指向调用对象时</li> <li>需要使用 <code>arguments</code> 时</li></ul> <p>由于箭头函数既没有自己的 <code>this</code>，也没有 <code>arguments</code>，因此这三种情况下无法使用箭头函数；</p> <p><strong>注意</strong>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token function-variable function">say</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
obj<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span>			<span class="token comment">// 10</span>
<span class="token keyword">var</span> anotherobj <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">}</span>
obj<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>anotherobj<span class="token punctuation">)</span>		<span class="token comment">// 10</span>
</code></pre></div><ul><li>对象并不算是一个块级作用域，在对象中定义的箭头函数，其 this 指向是指向 window 的；</li> <li>通过<code>call 和 apply</code> 调用箭头函数没有意义，因为箭头函数没有自己的 <code>this</code> 指针，因此在使用上述两方法调用时，第一个参数设置的 this 指向会被忽略；</li></ul> <h3 id="对象字面量的增强"><a href="#对象字面量的增强" class="header-anchor">#</a> 对象字面量的增强</h3> <hr> <blockquote><p>对象字面量：对象的写法 <code>const person = {}</code></p></blockquote> <p>属性的简洁表示法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 键名和变量或常量名一样时，可以只写一个属性名</span>
<span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// age: age</span>
    age
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>age<span class="token punctuation">)</span>		<span class="token comment">// 18</span>
</code></pre></div><p>方法的简洁表示法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 方法可以省略冒号和function关键字</span>
<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// speak: function () {}</span>
    <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>方括号语法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用prop给person添加一个age属性</span>
<span class="token keyword">const</span> prop <span class="token operator">=</span> <span class="token string">'age'</span><span class="token punctuation">;</span>
<span class="token comment">// 原始方法</span>
<span class="token comment">/*
cosnt person = {};
person[porp] = 18;
console.log(person.age);		// 18
*/</span>

<span class="token comment">// 方括号语法: 现在可以写在对象字面量中，在方括号中可以放任何可以求得值得表达式子</span>
<span class="token keyword">const</span> <span class="token function-variable function">func</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">'username'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'HH'</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// 18</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// HH</span>
</code></pre></div><p>相较于点语法，方括号语法的功能更加全面，而点语法就相当于方括号语法的特殊形式；</p> <p>当属性名由数字、字母、下划线以及$构成，且数字还不能打头时 (即合法标识符时)，使用点语法会更为便捷；</p> <h3 id="函数参数的默认值"><a href="#函数参数的默认值" class="header-anchor">#</a> 函数参数的默认值</h3> <hr> <blockquote><p>当不传参数，或者明确传递函数参数为 <code>undefined</code> 时，函数参数的默认值生效；</p> <p>如果默认值是表达式，默认值表达式是惰性求值；</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 一般写法</span>
<span class="token keyword">const</span> <span class="token function-variable function">multiply</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>y <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token number">0</span>
<span class="token comment">// 默认值写法</span>
<span class="token keyword">const</span> <span class="token function-variable function">multiply</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">*</span> y<span class="token punctuation">;</span>
</code></pre></div><p>tips：函数参数的默认值最好从参数列表的右边开始设置；</p> <h3 id="set-和-map"><a href="#set-和-map" class="header-anchor">#</a> Set 和 Map</h3> <hr> <blockquote><p><code>Set</code> ：是一系列<strong>无序的，没有重复值</strong>的数据集合；</p> <p>使用 <code>const s = new Set()</code> 实例化，与数组有点相像，但没有下标表示每一个值；</p></blockquote> <p><code>Set</code> 方法：</p> <ul><li><p><code>add()</code>：给 set 添加数据，可以连缀着写；</p></li> <li><p><code>has(num)</code>：检查  <code>set</code> 中是否含有 <code>num</code>，返回布尔值；</p></li> <li><p><code>delete(num)</code>：删除 <code>set</code> 中的 <code>num</code>，若没有 <code>num</code> 也不报错；</p></li> <li><p><code>clear()</code>：清除 <code>set</code> 中所有数字；</p></li> <li><p><code>forEach(function(value, key, set) {}, document);</code>：遍历顺序为成员添加进集合的顺序；</p> <p><code>forEach</code> 的第一个参数为回调函数：</p> <ul><li>其中 <code>value</code> 表示 <code>set</code> 中的值，由于 <code>set</code> 是无序的，因此 <code>key = vaule</code>；</li> <li>第三个参数 <code>set</code> 就是调用<code>forEach()</code>方法的 <code>set</code> 本身；</li></ul> <p><code>forEach</code> 的第二个参数为回调函数的 <code>this</code> 指向</p></li></ul> <p><code>set</code> 属性：</p> <ul><li><code>size</code>：等同于数组的 <code>length</code>，用于获取数组的长度；</li></ul> <p>创建 <code>Set</code> 时，其构造函数的参数：数组、类数组 (arguments, NodeList)、另一个set集合；</p> <p><code>Set</code> 的注意事项：</p> <ul><li><p><code>Set</code> 判断重复的方式：严格相等 (<code>===</code>)</p> <p>特别地，NaN 在 Set中是自等的；</p></li> <li><p>使用 Set 的时期：</p> <ol><li><p>数组或者字符串去重；</p></li> <li><p>不需要通过下标访问，而只需要遍历时；</p></li> <li><p>需要 Set 提供的方法和属性时；</p></li></ol></li></ul> <blockquote><p><code>Map</code> ：与对象相似，是键值对的集合；</p> <p>使用 <code>const m = new Map()</code> 实例化</p></blockquote> <p><code>Map</code> 和 <code>对象</code> 的区别：</p> <p>字符串一般使用字符串当作键，<code>Map</code> 可、以使用任何数据类型当作键；</p> <p><code>Map</code> 的方法：</p> <ul><li><p><code>set('键', '值')</code>：给 <code>Map</code> 添加数据，可以连缀着写，如果键已经存在，后添加的键值覆盖之前已有的；</p></li> <li><p><code>get(键)</code>：获取 <code>Map</code> 中某个键的值，键为什么类型就在括号里添加什么类型，不是字符串就不需要用单引号包裹；</p></li> <li><p><code>has(键)</code>：查找 <code>Map</code> 中是否含有某个键；</p></li> <li><p><code>delete(键)</code>：删除某个键，删除不存在的键，不会报错；</p></li> <li><p><code>clear()</code>：清除 <code>Map</code>;</p></li> <li><p><code>forEach(function (value, key, map) {}, this)</code>：遍历顺序为成员添加进集合的顺序；</p> <p><code>forEach</code> 的第一个参数为回调函数：</p> <ul><li><code>value</code> 表示键名对应的值；</li> <li><code>key</code> 表示键名对应的；</li> <li>q第三个参数就是<code>Map</code>本身；</li></ul> <p><code>forEach</code> 的第二个参数为回调函数的 <code>this</code> 指向；</p></li></ul> <p><code>set</code> 属性：</p> <ul><li><code>size</code>：等同于数组的 <code>length</code>，用于获取数组的长度；</li></ul> <p>创建 <code>Map</code> 时，其构造函数的参数：二维数组 (必须体现出键和值)、另一个 <code>Set\Map</code> 集合；</p> <p>使用 <code>Map</code> 的时期：</p> <ul><li>只需要单纯的 键值对 结构，或者需要字符串以外的类型做键；</li></ul> <h3 id="es6-新增方法"><a href="#es6-新增方法" class="header-anchor">#</a> ES6 新增方法</h3> <hr> <ul><li><p>字符串新增方方法</p> <ul><li><p><code>includes()</code> 判断字符串中是否含有某些字符</p> <p>第一个参数：表示需要查找的字符</p> <p>第二个参数：表示开始搜素字符串的位置</p> <p>实际开发中的<strong>运用</strong>：url的改变</p></li> <li><p><code>padStart() 和 padEnd()</code> 补全字符串</p> <p>第一个参数：表示期望长度</p> <p>第二个参数：表示补全长度使用的字符串，若此参数为空，则默认使用空格补全</p> <p><strong>注意</strong>：当原字符串大于最大长度，不会消减原字符串，而直接返回原字符串</p> <p>实际开发中的<strong>运用</strong>：显示日期的格式，位数不够自动补零</p></li> <li><p><code>trimStart() / trimLeft()</code>  和 <code>trimEnd() / trimRight()</code> 和 <code>trim()</code> 清除首尾空格</p> <p>实际开发中的<strong>运用</strong>：表单提交 验证</p></li></ul></li> <li><p>数组的新增方法</p> <ul><li><p><code>includes()</code> 判断数组中是否含有某些项</p> <p>注意：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span>， <span class="token number">4</span>， <span class="token number">9</span><span class="token punctuation">]</span>；
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// true</span>
</code></pre></div><p>由上可知，<code>includes()</code> 方法是按照 <strong>全等 (===)</strong> 严格判断的，其中特别提出 <strong>NaN 在 <code>includes()</code> 判断中，是相等的</strong>；</p></li> <li><p><code>reduce()</code> 对数组中的项做运算操作，参数应为一个回调函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">accumulator<span class="token punctuation">,</span> currentValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> accumulator <span class="token operator">*</span> currentValue<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr1<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>reducer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 120</span>
</code></pre></div><p>该方法的回调函数可以接收四个参数：</p> <ol><li>每次计算返回的值 <code>Accumulator (acc)</code></li> <li>当前遍历到的值 <code>Current Value (cur)</code></li> <li>当前遍历到的索引 <code>Current Index (idx)</code></li> <li>当前遍历数组 <code>Source Array (src)</code></li></ol> <p>特别的，该方法只会进行 <code>arr.length - 1</code> 次循环，直接将第二个数与第一个数做操作，然后次序向后遍历；</p> <p>另外，该方法可以接受第二个参数 <code>initialValue</code>，</p> <ul><li>如果没有提供 initialValue，那么第一次调用 <code>callback</code> 函数时，accumulator 使用原数组中的第一个元素，currentValue 即是数组中的第二个元素。 在没有初始值的空数组上调用 reduce 将报错。</li> <li>如果提供了 initialValue，那么将作为第一次调用 <code>callback</code> 函数时的第一个参数的值，即 accumulator，currentValue 使用原数组中的第一个元素。</li></ul> <p>若提供了第二个参数，则回循环 <code>arr.length</code> 次；</p></li> <li><p><code>filter()</code> 过滤数组中不想要的选项，返回符合条件的选项，并构造一个新数组</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newArr <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">ele<span class="token punctuation">,</span> index<span class="token punctuation">,</span> arr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ele<span class="token punctuation">,</span> index<span class="token punctuation">,</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ele <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> ele<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> thisArg<span class="token punctuation">)</span>
</code></pre></div><p>该方法接收两个参数：</p> <ul><li><p>回调函数</p> <ol><li><code>ele</code>：当前遍历到的元素</li> <li><code>index</code>：当前遍历元素的索引</li> <li><code>arr</code>：便利的数组</li></ol></li> <li><p><code>this</code> 指向</p></li></ul></li> <li><p><code>map()</code> 遍历数组或类数组，并对其中的项做一些操作(不止可以做计算)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 数组调用</span>
<span class="token keyword">let</span> kvArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>key<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
               <span class="token punctuation">{</span>key<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
               <span class="token punctuation">{</span>key<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">]</span>

<span class="token keyword">let</span> reformattedArray <span class="token operator">=</span> kvArray<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token keyword">let</span> rObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   rObj<span class="token punctuation">[</span>obj<span class="token punctuation">.</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">.</span>value
   <span class="token keyword">return</span> rObj
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// reformattedArray = [{1: 10}, {2: 20}, {3: 30}], </span>

<span class="token comment">// 类数组调用</span>
<span class="token keyword">let</span> map <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>map
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token function">map</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">'Hello World'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">return</span> x<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// a = [72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100]</span>
</code></pre></div><p>可传参数与 <code>filter</code> 相同；</p></li> <li><p><code>Array.from()</code> 将其他可便利对象转换为数组</p> <p>若为不可便利的数组调用此方法，则返回一个空数组；</p> <p>特殊地，如果一个对象<strong>为不可便利对象，但其含有 <code>length</code> 属性</strong>，也可以使用该方法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token operator">:</span> <span class="token string">'HH.'</span><span class="token punctuation">,</span>
    <span class="token number">2</span><span class="token operator">:</span> <span class="token string">'WW.'</span><span class="token punctuation">,</span>
    date<span class="token operator">:</span> <span class="token number">9999</span><span class="token punctuation">,</span>
    <span class="token number">4</span><span class="token operator">:</span> <span class="token string">'yeah'</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// [undefined, 'HH.', 'WW.', undefined]</span>
</code></pre></div><p>由上可知，该对象虽然被转为了数组，但只有<strong>属性名有下标指向的才可以被转化为数组中具体的项，且超过长度的项会被省略</strong>；</p> <p>该方法一般用于：对某可便利对象进行一些操作，然后存入一个新数组中，省去了遍历的麻烦；</p></li> <li><p><code>find() 和 findIndex()</code> 在数组中查找满足某一条件的第一个数，并且返回其本身 或 其索引，可遍历属性才可调用该方法</p> <p>第一个参数：<code>callback(element, index, arr)</code> 函数；</p> <p>​						三个参数类似forEach的参数：</p> <p>​						element：当前遍历的值；</p> <p>​						index：当前 element 在数组中的索引；</p> <p>​						arr：当前调用 <code>find() / findIndex()</code> 方法的数组；</p> <p>第二个参数：this 指向，这里特别注意，若回调函数使用了箭头函数的写法，则无论 this 指向如何设置，都不会改变；</p></li></ul> <p>问题：为什么有些方法可以通过实例调用，有些方法只能通过构造函数调用，实例不应该继承了构造函数的方法吗；</p> <p><strong>实例方法就类似class中直接设置的方法，可以被每创建一个实例，则会创建属于自己的方法，而构造函数的方法类似于class中的静态方法 <code>static</code> 是不会被继承的</strong></p></li> <li><p>对象的新增方法</p> <ul><li><p>Object.assign(目标对象， 源对象)</p> <p>基本数据类型作为源对象，会先转换为对象，再并入目标对象中；</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 与展开运算符的区别就是</span>
<span class="token keyword">let</span> apple <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'apple'</span><span class="token punctuation">,</span>
    color<span class="token operator">:</span> <span class="token string">'red'</span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token string">'eat'</span><span class="token punctuation">,</span>
    date<span class="token operator">:</span> <span class="token string">'2021-01-04'</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> pen <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'pen'</span><span class="token punctuation">,</span>
    color<span class="token operator">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token string">'write'</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> newObj <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>apple<span class="token punctuation">,</span> <span class="token operator">...</span>pen <span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj <span class="token operator">===</span> apple<span class="token punctuation">)</span>        <span class="token comment">// false</span>
<span class="token keyword">let</span> assignObj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>apple<span class="token punctuation">,</span> pen<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>assignObj <span class="token operator">===</span> apple<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// true</span>
</code></pre></div><p>即展开运算符是直接创建一个新对象，而该方法是直接修改目标对象；</p> <p>在源对象和目标对象中若存在同名属性：无论是什么数据类型，都是源对象覆盖目标对象；</p></li> <li><p>Object.keys() 、Object.values() 、Object.entries()</p> <p>与数组方法不同点：</p> <ol><li>对象是构造函数方法，数组是实例方法</li></ol> <p>通过三个方法使用 for...of...</p> <p>注意：但其不保证顺序</p></li></ul></li></ul> <h3 id="promise-异步函数"><a href="#promise-异步函数" class="header-anchor">#</a> Promise 异步函数</h3> <hr> <blockquote><p><code>Promise</code> 是异步操作的解决方案，一般用来<strong>解决层层嵌套</strong> (回调地狱 callback hell)  的回调函数；</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 例题：小盒子的移动</span>
</code></pre></div><p>使用 Promise (实例化 <code>Promise</code> 构造函数)：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1.resolve();   // pending -&gt; fullfilled</span>
    <span class="token comment">// 2.reject();	 // pending -&gt; rejected</span>
    <span class="token comment">/*
       3.
       resolve();
       reject();
       // pending -&gt; fullfilled
    */</span>
    <span class="token comment">// 这里的 reject() 常传参为 reject(new Error())，表示错误原因</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>注意：一定要传回调函数作为参数，否则报错；</p> <p><code>Promise</code> 的三 个状态：</p> <ul><li><p><code>pending</code>：初始态，刚刚初始化的 <code>Promise</code> 为这个状态，认为是未完成 或 等待态；</p></li> <li><p><code>fullfilled / resolved</code>：成功态，执行 <code>resolve()</code> 变为此状态，认为是已成功；</p></li> <li><p><code>rejected</code>：失败态，执行 <code>reject()</code> 变为此状态，认为是已失败；</p></li></ul> <p>这里值得一提的是上文中的第三种情况：先调用 <code>resolve()</code> 后调用 <code>reject()</code> ，那么最终态就是 <code>fullfilled</code> ，因为 <strong>Promise 的状态一旦变化就不会再改变</strong>;</p> <p><code>then()</code> 方法：</p> <div class="language-js extra-class"><pre class="language-js"><code>p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    	<span class="token comment">// 当执行 resolve() 执行该函数中的语句</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token parameter">reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 当执行 reject() 执行该函数中的语句</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>同时，then() 方法中可以接收 <code>resolve() 和 reject()</code> 中传的参数；</p> <p>由上可知：</p> <ul><li><p><code>pending -&gt; fullfilled</code> 时，执行 <code>then</code> 的第一个回调函数；</p></li> <li><p><code>pending -&gt; rejected</code> 时，执行 <code>then</code> 的第二个回调函数；</p></li></ul> <p>且在 <strong><code>then</code> 执行后返回一个新的 <code>Promise</code> 对象</strong>；</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> p2 <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p2 <span class="token operator">===</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// false</span>
p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
	<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sucess1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token comment">// 	等同于return undefined；</span>
        <span class="token comment">/*
            等同于: 
            return new Promise((resolve) =&gt; {
            	resolve(undefined);
            });
        */</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
		<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sucess2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 控制台输出 err1 sucess2</span>
</code></pre></div><p>由上可知，<code>p.then()</code> 返回的 <code>Promise</code> 对象的状态与 <code>p</code> 对象的状态无关，该 新 <code>Promise</code> 对象其实是在执行了回调函数的语句后，<code>return</code> 语句是以创建一个 <code>Promise</code> 对象的方式执行的，且默认在该 <code>Promise</code> 中会执行 <code>resolve()</code>，而 <code>return</code> 的内容就是 <code>resolve</code> 的参数；</p> <p><code>catch()</code> 方法：</p> <p>一般情况下，<code>then()</code> 方法被用来处理 <code>resolve()</code> 的状态，而当出现异常时我们一般不去调用 <code>then()</code> 方法的第二个回调函数，而是使用 <code>catch()</code> 处理出现的异常；</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'reason'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
    <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  	<span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>
	<span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果一个异常没有被捕获，那么他将会一直向下传递直至被捕获为止；</p> <p>其实 <code>catch()</code> 算是一种特殊的 <code>then()</code>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 等同于</span>
<span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 由上可知，每次then执行完毕后都会返回一个默认成功状态的 Promise</span>
<span class="token comment">// 我们可以通过 return 的方式将 Promise 改为默认错误的</span>
<span class="token comment">// 但是同时也可以使用简写方法</span>
<span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// programming</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'reason'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>finally()</code> 方法：</p> <p>表达一个 <code>Promise</code> 的状态，若变化则会调用该方法，不变则不调用；</p> <p><code>Promise.resolve() / Promise.rejecte()</code> ：</p> <div class="language-js extra-class"><pre class="language-js"><code>Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'HH'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 等同于</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'HH'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'WW'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 等同于</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'WW'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>换而言之，以上两种方法类似于构造函数 <code>Promise</code> 的简写形式；</p> <p>参数：</p> <ul><li><p><code>Promise.resolve()</code> 的三种形式：</p> <ol><li><p>一般参数：原封不动的向后传递；</p></li> <li><p>一个 <code>Promise</code> 对象作为参数：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token string">'OK'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 该写法形同</span>
    <span class="token comment">// setTimeout(() =&gt; {</span>
    <span class="token comment">//     console.log('OK');</span>
    <span class="token comment">// }, 2000)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 2s后输出OK，但不输出end</span>
<span class="token comment">// 因为以上的写法就等同于</span>
p1<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>因此可知，当 Promise 作为参数传入时，等同于 0参数Promise 直接调用 <code>then()</code>;</p></li> <li><p>当一个含有 <code>then()</code> 方法的对象传入时：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ending'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'then'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出 ending</span>
</code></pre></div></li></ol> <p><code>Promise.all()</code>：</p> <p>同时监听多个 <code>Promise</code> 对象的状态</p></li></ul> <h3 id="await-和-async"><a href="#await-和-async" class="header-anchor">#</a> await 和 async</h3> <hr> <blockquote><p>ES7 新语法，async 是“异步”的简写，而 await 可以认为是 async wait 的简写。所以应该很好理解 async 用于申明一个 function 是异步的，而 await 用于等待一个异步方法执行完成；</p> <p>await 只能出现在 async 声明的函数中，两者结合目的是为了彻底消灭编码中的回调函数，实现异步调用&quot;扁平化&quot;；</p></blockquote> <p>async 会将一个普通函数的返回值改造为一个 <code>Promise</code> 对象，普通函数 <code>retrun</code> 的值作为 <code>Promise.resolve()</code> 的参数，因此应该使用 <code>.then().catch()</code> 来处理该对象；</p> <p>await 关键字写在一个异步函数前，等待的是一个的返回值，<code>await</code> 像是一个<strong>运算符</strong>，用于组成表达式，该表达式的<strong>运算结果</strong>取决于 <code>await</code> 等到的返回值：</p> <ul><li><p>若等到的不是一个 <code>Promise</code> 对象，则运算结果就是返回值自身；</p></li> <li><p>反之则会<strong>阻塞</strong>后面的代码，等待 <code>Promise</code> 对象 <code>resolve</code>，<code>resolve</code> 的值作为 <code>await</code> 表达式的运算结果；</p> <p>但是，若将 <code>await</code> 书写在由 <code>async</code> 声明的函数中，则不会发生阻塞，因为 <code>async</code> 函数内部搜有的阻塞都会被封装在 <code>Promise</code> 对象中异步执行；</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 实现目标</span>
<span class="token keyword">function</span> <span class="token function">takeLongTime</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 返回一个Promise对象</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// n秒后，定时器触发回调函数 resolve()</span>
        <span class="token comment">// 并返回一个新的成功态Promise对象，参数为 n+1000</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token function">resolve</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">step1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">step1 with </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>n<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 每执行一步返回一个新Promise对象</span>
    <span class="token keyword">return</span> <span class="token function">takeLongTime</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">step2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">step2 with </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>n<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 每执行一步返回一个新Promise对象</span>
    <span class="token keyword">return</span> <span class="token function">takeLongTime</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">step3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">step3 with </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>n<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 每执行一步返回一个新Promise对象</span>
    <span class="token keyword">return</span> <span class="token function">takeLongTime</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Promise写法：</span>
<span class="token keyword">function</span> <span class="token function">doIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">step1</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">time2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">step2</span><span class="token punctuation">(</span>time2<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">time3</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">step3</span><span class="token punctuation">(</span>time3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">doIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// await写法</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">asyncDoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这样使的代码看起来像是同步编程，完全解决了回调问题</span>
    <span class="token keyword">const</span> time2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">step1</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> time3 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">step2</span><span class="token punctuation">(</span>time2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">step3</span><span class="token punctuation">(</span>time3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">asyncDoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>因为 <code>await</code> 只会接收到 <code>Promise resolve</code> 的结果，无法接收错误，因此可以选择以下几种处理错误的方式：</p> <ul><li><code>try...catch</code>(推荐)：将 <code>await</code> 语句放在 <code>try</code> 中，对错误的处理放在 <code>catch</code> 中，并且 <code>catch</code> 接收一个参数 <code>err</code>，表示错误原因，但是此方法的缺陷是会捕获一些不会被 <code>Promise</code> 捕获的错误，但当这个错误是由 <code>catch</code> 而不是由 js 本身打印出来时，其中一个调用者吞噬了错误，就非常难找到；</li> <li>让函数返回两个值：<code>[err, user] = await to(UserModel.findById(1))</code></li> <li><code>.catch</code> 继续接收：但是此方法错误路径先于正常路径，非常不直观；</li></ul> <h3 id="class类"><a href="#class类" class="header-anchor">#</a> Class类</h3> <hr> <blockquote><p>两个或多个对象的结构功能类似，可以抽象出一个模板，依照模板复制出多个相似的对象。通过类来创建对象，使得不必写重复代码达到代码复用的目的。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token comment">// 实例属性设置方法一：</span>
    <span class="token comment">// 可看作给类属性设置了默认值</span>
    <span class="token comment">// 但若于constructor中需要赋值的变量重复则无论传不传参都会被覆盖</span>
    name <span class="token operator">=</span> <span class="token string">'WW'</span><span class="token punctuation">;</span>
    age <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	sex <span class="token operator">=</span> <span class="token string">'male'</span><span class="token punctuation">;</span>

    <span class="token comment">// 在constructor中定义属性相当于将属性定义在了本身中</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> sex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 实例属性设置方法二：</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 在类本身定义方法其实相当于在其原型链上定义属性</span>
    <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">hello, my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 以上两种定义形式也符合构造函数构造一个对象的要求</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token constant">H</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'HH.'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">'male'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">H</span><span class="token punctuation">.</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// hello, my name is HH</span>
</code></pre></div><p>创建方法类似构造函数，类本质上也是一个函数：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">typeof</span> <span class="token keyword">class</span> <span class="token operator">==</span> <span class="token string">&quot;function&quot;</span>		<span class="token comment">// true</span>
</code></pre></div><p><strong>静态方法和静态属性</strong>：通过类方法调用 <code>Person.hello()</code></p> <p>静态方法中的this指向类本身，不可以被实例调用，与之相反，实例方法中的this指向实例；</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 方法一：class内部添加</span>
<span class="token keyword">static</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我是Person的hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 方法二：class外部添加</span>
Person<span class="token punctuation">.</span><span class="token function-variable function">hello</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我是Person的hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>静态属性设置时，一般使用静态方法设置</p> <p><strong>私有属性和方法</strong>：</p> <ol><li>下划线开头表示私有</li> <li>将私有的属性和方法移除类</li></ol> <p>类继承：<code>extends</code> 复制子类的方法，并拓展自己的功能，达到代码复用的效果；</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/27/2021, 7:52:43 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/accumulate/base/JS_base/BOM.html" class="prev">
        BOM
      </a></span> <span class="next"><a href="/accumulate/base/JS_base/regExp.html">
        正则表达式
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b204aa68.js" defer></script><script src="/assets/js/3.11858a94.js" defer></script><script src="/assets/js/28.95fa210b.js" defer></script>
  </body>
</html>
